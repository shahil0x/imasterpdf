<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to PDF Converter - iMasterPDF</title>
    <meta name="description" content="Convert plain text to PDF online. Create PDF documents from text content." />
    <meta name="keywords" content="Text to PDF, create PDF from text, text converter, PDF creator" />
    <meta name="author" content="iMasterPDF" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6782945468754840"
     crossorigin="anonymous"></script>

    <style>
        :root {
            --primary-color: #2d8cff;
            --secondary-color: #ff4757;
            --success-color: #2ed573;
            --dark-color: #2f3542;
            --light-color: #f1f2f6;
            --gray-color: #a4b0be;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --transition: all 0.3s ease;
            --card: #ffffff;
            --border: #e2e8f0;
            --text: #374151;
            --muted: #6b7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark-color);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .logo i {
            font-size: 1.8rem;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 500;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        /* Tool Header */
        .tool-header {
            text-align: center;
            padding: 3rem 0 2rem;
        }

        .tool-header h1 {
            font-size: 2.2rem;
            margin-bottom: 0.8rem;
            color: var(--dark-color);
        }

        .tool-header p {
            color: var(--muted);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* How-to Guide */
        .how-to-guide {
            background: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
        }

        .how-to-guide h3 {
            margin: 0 0 12px;
            font-size: 1.2rem;
            color: var(--dark-color);
        }

        .how-to-guide ol {
            margin: 0 0 10px 0;
            padding-left: 20px;
        }

        .how-to-guide li {
            margin-bottom: 8px;
            color: var(--text);
            line-height: 1.5;
        }

        .how-to-guide .note {
            font-size: 0.85rem;
            color: var(--muted);
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px dashed var(--border);
            font-style: italic;
        }

        /* Text Input Area */
        .text-input-area {
            background: white;
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }

        .text-input-area h3 {
            margin: 0 0 15px;
            font-size: 1.2rem;
            color: var(--dark-color);
            text-align: center;
        }

        .text-input {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            font-size: 1rem;
            font-family: inherit;
            line-height: 1.6;
            resize: vertical;
            background: var(--light-color);
            transition: var(--transition);
        }

        .text-input:focus {
            outline: none;
            border-color: var(--primary-color);
            border-style: solid;
            background: white;
            box-shadow: 0 0 0 3px rgba(45, 140, 255, 0.1);
        }

        .text-stats {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--muted);
            text-align: right;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            justify-content: center;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 180px;
            font-size: 1rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background: var(--secondary-color);
        }

        .btn:disabled {
            background: var(--gray-color);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Message */
        .msg {
            padding: 12px 16px;
            border-radius: var(--radius);
            margin: 1rem 0;
            display: none;
            text-align: center;
        }
        
        .msg.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
            display: block;
        }
        
        .msg.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
            display: block;
        }
        
        .msg.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
            display: block;
        }
        
        .msg.warning {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
            display: block;
        }

        /* Progress Container */
        .progress-container {
            display: none;
            margin: 2rem 0;
            text-align: center;
        }

        .progress-container.active {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--light-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: var(--light-color);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 0.5rem;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        /* Result Area */
        .result-area {
            background: white;
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            text-align: center;
            display: none;
            margin-bottom: 2rem;
        }

        .result-area.active {
            display: block;
        }

        .result-area i {
            font-size: 3.5rem;
            color: var(--success-color);
            margin-bottom: 1rem;
        }

        .result-area h3 {
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .result-area p {
            color: var(--muted);
            margin-bottom: 1.5rem;
        }

        /* Footer */
        footer {
            margin-top: 3rem;
            border-top: 1px solid var(--border);
            background: #fafafa;
            padding: 1.5rem 0;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .footer-links a {
            color: var(--muted);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .footer-links a:hover {
            color: var(--primary-color);
        }

        .copyright {
            text-align: center;
            color: var(--muted);
            font-size: 0.8rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem 0;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem;
            }

            .tool-header h1 {
                font-size: 1.8rem;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo">
                    <i class="fas fa-file-pdf"></i>
                    iMasterPDF
                </a>
                <div class="nav-links">
                    <a href="index.html">Home</a>
                    <a href="blog.html">Blog</a>
                    <a href="about.html">About</a>
                    <a href="contact.html">Contact</a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Tool Header -->
        <div class="tool-header">
            <h1>Convert Text to PDF</h1>
            <p>Create PDF documents from plain text content</p>
        </div>

        <!-- How-to Guide -->
        <div class="how-to-guide">
            <h3>How to convert text to PDF:</h3>
            <ol>
                <li>Paste or type your text in the text area below</li>
                <li>Click "Create PDF" to generate your document</li>
                <li>Download the generated PDF file</li>
            </ol>
            <div class="note">Note: All text is processed securely on our servers and deleted after conversion.</div>
            <div class="note">ðŸ”„ <strong>Quick keys:</strong> Press Ctrl+Enter to create PDF</div>
        </div>

        <!-- Text Input Area -->
        <div class="text-input-area">
            <h3>Enter Your Text</h3>
            <textarea class="text-input" id="textInput" placeholder="Enter or paste your text here... (Minimum 10 characters)" oninput="updateTextStats()"></textarea>
            <div class="text-stats">
                <span id="charCount">0</span> characters, <span id="wordCount">0</span> words
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn" id="createPdfBtn" onclick="processText()">
                <i class="fas fa-file-pdf"></i> Create PDF
            </button>
            <button class="btn btn-secondary" onclick="resetTool()">
                <i class="fas fa-redo"></i> Start Over
            </button>
        </div>

        <!-- Message Area -->
        <div class="msg" id="message"></div>

        <!-- Progress Container -->
        <div class="progress-container" id="progressContainer">
            <div class="spinner"></div>
            <h3>Creating PDF from Text...</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
                <div class="progress-text" id="progress-text">0%</div>
            </div>
        </div>

        <!-- Result Area -->
        <div class="result-area" id="resultArea">
            <i class="fas fa-check-circle"></i>
            <h3>PDF Created Successfully!</h3>
            <p>Your PDF document has been generated successfully.</p>
            <a id="downloadLink" class="btn" style="margin-top: 1rem;">
                <i class="fas fa-download"></i> Download PDF
            </a>
            <button class="btn btn-secondary" onclick="resetTool()" style="margin-top: 1rem;">
                <i class="fas fa-redo"></i> Create Another PDF
            </button>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="index.html">Home</a>
                <a href="blog.html">Blog</a>
                <a href="about.html">About</a>
                <a href="contact.html">Contact</a>
                <a href="privacy.html">Privacy</a>
                <a href="terms.html">Terms</a>
            </div>
            <div class="copyright">
                Â© <span id="year"></span> iMasterPDF. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        // Initialize
        document.getElementById('year').textContent = new Date().getFullYear();

        // Text statistics
        function updateTextStats() {
            const text = document.getElementById('textInput').value;
            const charCount = text.length;
            const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            
            document.getElementById('charCount').textContent = charCount;
            document.getElementById('wordCount').textContent = wordCount;
            
            // Enable/disable create button based on text length
            const createBtn = document.getElementById('createPdfBtn');
            createBtn.disabled = text.trim().length < 10;
        }

        // Validate text input
        function validateText() {
            const text = document.getElementById('textInput').value.trim();
            if (text.length < 10) {
                showMessage('Please enter at least 10 characters of text', 'error');
                document.getElementById('textInput').focus();
                return false;
            }
            return true;
        }

        // Text processing - FIXED VERSION for Flask backend
        async function processText() {
            if (!validateText()) {
                return;
            }
            
            const text = document.getElementById('textInput').value.trim();
            
            // Hide action buttons during processing
            document.querySelector('.action-buttons').style.display = 'none';
            
            // Show progress
            document.getElementById('progressContainer').classList.add('active');
            document.getElementById('progress-fill').style.width = '10%';
            document.getElementById('progress-text').textContent = '10%';
            document.getElementById('message').style.display = 'none';
            
            try {
                // Update progress
                document.getElementById('progress-fill').style.width = '30%';
                document.getElementById('progress-text').textContent = '30%';
                
                // IMPORTANT: Your Flask backend expects form data, not JSON
                // Create FormData object instead of JSON
                const formData = new FormData();
                formData.append('text', text);
                
                // Send request to Flask backend - Using FormData as your backend expects
                const response = await fetch('/api/text-to-pdf', {
                    method: 'POST',
                    body: formData  // Using FormData, not JSON
                });
                
                // Check if request was successful
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Server error: ${response.status} - ${errorText}`);
                }
                
                // Update progress
                document.getElementById('progress-fill').style.width = '70%';
                document.getElementById('progress-text').textContent = '70%';
                
                // Get response as blob (binary data - PDF file)
                const blob = await response.blob();
                
                // Check if we got a PDF
                if (blob.size === 0) {
                    throw new Error('Server returned empty PDF file');
                }
                
                // Check content type
                const contentType = response.headers.get('content-type') || blob.type;
                const isPdf = contentType.includes('application/pdf') || 
                             contentType.includes('application/octet-stream');
                
                if (!isPdf) {
                    // Try to read as text to see error message
                    const textResponse = await blob.text();
                    console.error('Non-PDF response:', textResponse);
                    
                    // Check if it's a JSON error response
                    if (textResponse.startsWith('{') || textResponse.includes('error')) {
                        try {
                            const errorObj = JSON.parse(textResponse);
                            throw new Error(errorObj.error || errorObj.message || 'Server returned an error');
                        } catch {
                            // If not JSON, show the text response
                            throw new Error('Server error: ' + textResponse.substring(0, 200));
                        }
                    } else {
                        throw new Error('Server returned non-PDF response. Content-Type: ' + contentType);
                    }
                }
                
                // Complete progress
                document.getElementById('progress-fill').style.width = '100%';
                document.getElementById('progress-text').textContent = '100%';
                
                // Extract filename from headers if available
                const contentDisposition = response.headers.get('content-disposition');
                let filename = 'text_document.pdf';
                
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="([^"]+)"/) || 
                                        contentDisposition.match(/filename=([^;]+)/);
                    if (filenameMatch && filenameMatch[1]) {
                        filename = filenameMatch[1].trim();
                    }
                }
                
                // Ensure filename has .pdf extension
                if (!filename.toLowerCase().endsWith('.pdf')) {
                    filename += '.pdf';
                }
                
                // Show result after short delay
                setTimeout(() => {
                    document.getElementById('progressContainer').classList.remove('active');
                    document.getElementById('resultArea').classList.add('active');
                    
                    // Create download link with the actual PDF from backend
                    const downloadUrl = URL.createObjectURL(blob);
                    const downloadLink = document.getElementById('downloadLink');
                    downloadLink.href = downloadUrl;
                    downloadLink.download = filename;
                    
                    // Add click handler to clean up URL object
                    downloadLink.onclick = () => {
                        setTimeout(() => URL.revokeObjectURL(downloadUrl), 100);
                    };
                    
                    // Scroll to result
                    document.getElementById('resultArea').scrollIntoView({ behavior: 'smooth' });
                    
                    // Show success message
                    const wordCount = text.trim().split(/\s+/).length;
                    const charCount = text.length;
                    showMessage(`PDF created successfully! ${wordCount} words (${charCount} characters) converted to PDF.`, 'success');
                    
                }, 500);
                
            } catch (error) {
                console.error('Error:', error);
                showMessage('Failed to create PDF: ' + error.message, 'error');
                document.getElementById('progressContainer').classList.remove('active');
                document.querySelector('.action-buttons').style.display = 'flex';
            }
        }

        function showMessage(text, type) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = 'msg ' + type;
            msg.style.display = 'block';
            
            // Auto-hide non-error messages after 5 seconds
            if (type !== 'error') {
                setTimeout(() => {
                    if (msg.textContent === text) {
                        msg.style.display = 'none';
                    }
                }, 5000);
            }
        }

        function resetTool() {
            document.getElementById('textInput').value = '';
            document.getElementById('resultArea').classList.remove('active');
            document.getElementById('progressContainer').classList.remove('active');
            document.getElementById('message').style.display = 'none';
            document.querySelector('.action-buttons').style.display = 'flex';
            
            updateTextStats();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Optionally show reset message
            // showMessage('Tool has been reset. Enter your text to create a new PDF.', 'info');
        }

        // Handle Enter key in textarea (Ctrl+Enter to submit)
        document.getElementById('textInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.ctrlKey) {
                e.preventDefault();
                processText();
            }
        });

        // Initialize text stats and button state
        document.addEventListener('DOMContentLoaded', () => {
            updateTextStats();
            
            // Add sample text for testing
            const sampleText = `Welcome to iMasterPDF Text to PDF Converter!

This tool allows you to convert any text content into a professional PDF document.

Simply enter or paste your text above and click "Create PDF" to generate your document.

Features:
- Preserves line breaks and paragraphs
- Secure server-side processing
- Fast and reliable conversion
- High-quality PDF output

Your text is securely processed on our servers and deleted immediately after conversion. No data is stored or shared with third parties.

Try it now with your own content!`;
            
            document.getElementById('textInput').value = sampleText;
            updateTextStats();
            
            // Focus the textarea
            document.getElementById('textInput').focus();
        });
        
        // Add paste event listener for better UX
        document.getElementById('textInput').addEventListener('paste', (e) => {
            // Give a small delay for the paste to complete
            setTimeout(updateTextStats, 10);
        });
        
        // Add drag and drop for text files
        const textInput = document.getElementById('textInput');
        
        textInput.addEventListener('dragover', (e) => {
            e.preventDefault();
            textInput.style.borderColor = 'var(--primary-color)';
            textInput.style.backgroundColor = 'rgba(45, 140, 255, 0.05)';
        });
        
        textInput.addEventListener('dragleave', (e) => {
            textInput.style.borderColor = 'var(--border)';
            textInput.style.backgroundColor = 'var(--light-color)';
        });
        
        textInput.addEventListener('drop', async (e) => {
            e.preventDefault();
            textInput.style.borderColor = 'var(--border)';
            textInput.style.backgroundColor = 'var(--light-color)';
            
            const files = Array.from(e.dataTransfer.files);
            const textFile = files.find(file => 
                file.type === 'text/plain' || 
                file.name.endsWith('.txt') ||
                file.type.startsWith('text/')
            );
            
            if (textFile) {
                try {
                    const text = await textFile.text();
                    document.getElementById('textInput').value = text;
                    updateTextStats();
                    showMessage(`Text file "${textFile.name}" loaded successfully.`, 'success');
                } catch (error) {
                    showMessage(`Failed to read text file: ${error.message}`, 'error');
                }
            } else if (files.length > 0) {
                showMessage('Please drop a text file (.txt) or enter text directly.', 'warning');
            }
        });
        
        // Add keyboard shortcut for accessibility
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + S to create PDF
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                if (document.getElementById('textInput').value.trim().length >= 10) {
                    processText();
                }
            }
        });
    </script>
</body>
</html>